# 秒传生成相关

秒传脚本自带生成秒传链接的功能, 此文档用于帮助用户解决相关问题. 

PS: 文档将持续/不定时更新, 更新时间: 21.1.14

- [秒传生成相关](#秒传生成相关)
	- [注意事项](#注意事项)
	- [常见问题及解决方法](#常见问题及解决方法)
		- [md5获取失败/秒传无效](#md5获取失败秒传无效)
			- [解决方法 (秒传无效)](#解决方法-秒传无效)
			- [预防方法 (秒传无效)](#预防方法-秒传无效)
		- [文件和谐](#文件和谐)
			- [解决方法 (文件和谐)](#解决方法-文件和谐)
			- [预防方法 (文件和谐)](#预防方法-文件和谐)
	- [文件压缩方法](#文件压缩方法)
		- [工具选择及选项配置](#压缩选项配置)
			- [WinRAR](#WinRAR)
			- [好压](#好压)
			- [7zip](#7zip)
		- [双层压缩(可选)](#双层压缩-可选)
		- [测试压缩文件](#测试压缩文件)
	- [PCS-Go客户端使用方法](#PCS-Go客户端使用方法)
		- [下载安装](#下载安装)
		- [注意事项 (PCS-Go)](注意事项-PCS-Go)
		- [登录](#登录)
		- [上传](#上传)
	- [修改文件md5方法](#修改文件md5方法)
		- [重新压缩](#重新压缩)
		- [md5修改工具](#md5修改工具)

## 注意事项
1. 2020年10月后上传的文件, 被和谐后, 源文件(首次上传的文件)可能仍然可以正常下载/分享, 但秒传转存的文件则报和谐, 故在测试文件和谐时, 应以转存的文件为准.

## 常见问题及解决方法

### md5获取失败/秒传无效
- 生成秒传及转存秒传报对应弹窗即秒传无效, 上传文件过程中网络波动可能会造成该情况
- 等待一段时间(几小时到一天)秒传可能重新生效,
- 若不想等待或等待后依旧无效, 可尝试使用下方提供的解决方法。

#### 解决方法 (秒传无效)
1. 修改文件的md5，参考[修改文件md5方法](#修改文件md5方法)，
2. 使用 “度盘客户端” 或 “[PCS-Go客户端](#PCS-Go客户端使用方法)(推荐)” 上传文件, 不推荐使用度盘网页端上传
3. 重新生成上传文件的秒传

#### 预防方法 (秒传无效)
1. 单个文件的大小控制在2G以内, 过大的文件可分卷压缩
2. 见上方 "解决方法" 2.

### 文件和谐
生成秒传时提示如下弹窗, 或者下载文件时报和谐, 即文件被和谐, 文件被和谐后没有任何补救方法.
![avatar](https://pic.rmb.bdstatic.com/bjh/2da6fe7376b1097cb2061d48df8a679f.png)

#### 解决方法 (文件和谐)
方法同 [解决方法(秒传无效)](#解决方法-秒传无效)

#### 预防方法 (文件和谐)
1. 将文件压缩为不支持在线解压格式, 方法见[文件压缩方法](#文件压缩方法)
2. 不通过创建分享链的方式分享

## 文件压缩方法

### 工具选择及选项配置
篇幅有限仅列举三种工具, 使用其他工具可自行参考. 防在线解压涉及的压缩选项有两个, 分别是 "固实压缩" 和 "加密文件名".

#### WinRAR
用于压缩rar格式的压缩包, 请前往[WinRAR官网](http://www.winrar.com.cn/)下载安装最新, 请务必使用最新版本, 使用旧版本WinRAR压缩的rar4格式是无法防止在线解压的.

- 选项配置
	1. 固实压缩

	![avatar](https://pic.rmb.bdstatic.com/bjh/6ae0d1dc1db52cff958513dcfd8faa0c.png)

	2. 加密文件名

	![avatar](https://pic.rmb.bdstatic.com/bjh/44704c6ee17b71d47356b8a0c808f8ed.png)

### 好压
用于压缩7z格式的压缩包, 请前往[好压官网](https://haozip.2345.cc/),下载安装最新版

- 选项配置
	1. 固实压缩
	
	![avatar](https://pic.rmb.bdstatic.com/bjh/60443511e18e787a987b9d208c758550.png)

	2. 加密文件名
	
	![avatar](https://pic.rmb.bdstatic.com/bjh/863823e535d37c919a6f6812f8018bc9.png)

### 7zip
用于压缩7z格式的压缩包, 请前往[7zip](https://www.7-zip.org/),下载安装最新版

- 选项配置
	- 固实压缩&加密文件名
	
	![avatar](https://pic.rmb.bdstatic.com/bjh/6c4921617256946086b6d9eb881562a6.png)


### 双层压缩(可选)
如题, 使用上述相同的压缩选项将压缩包再压缩一次, 据说可以有效防和谐, 一般使用单层压缩的防和谐效果已经足够.

### 测试压缩文件
在度盘客户端/网页端中点击文件即可测试在线解压(自备会员), 7z文件注意先将后缀改为rar再测试.

若测试显示下图所示弹窗(且不提示输入解压密码), 即不支持在线解压, 即可以放心使用自己的压缩工具和选项配置.

![avatar](https://pic.rmb.bdstatic.com/bjh/eb5e4c6ed0e93b12f00f6bbcd8acf540.png)

## PCS-Go客户端使用方法
### 下载安装
请前往[蓝奏云](https://wws.lanzous.com/b01tvsfyj)下载客户端, 提供32位(x86)和64位(x64)的exe文件, 单文件免安装

### 注意事项 (PCS-Go)
- 该客户端无交互界面(GUI), 仅有命令行界面(CMD), 存在一定使用门槛.
- 该客户端的命令行界面中Ctrl+C为退出, 鼠标右键为复制/粘贴
- 该客户端支持无会员上传4G-20G的单文件

### 登录
1. 账号密码登录: 输入login命令, 回车, 然后输入对应信息即可(输入密码时是不显示的, 直接回车即可)

2. bduss登录(推荐): 如何获取bduss请自行百度, 输入命令login -bduss=, 然后复制你的bduss, 右键粘贴上去(粘贴时界面可能会刷新不出来, 此时按一下空格即可), 然后回车即可登录

### 上传
- 输入命令upload或u即可上传文件/文件夹, 
	- 注意添加-p 1参数使用单线程上传, 防止秒传无效.
	- 若上传过程中报400网络错误, 请添加-retry 100参数, 报错后可自动继续上传.
- 命令格式: u -p 1 -retry 100 "本地路径" "网盘路径" (注意空格分隔)
- 命令示例: 
	u -p 1 -retry 100 "D:\download" "/"  #将download文件夹上传到网盘根目录
	u -p 1 -retry 100 "D:\download\test.7z" "/测试"  #将test.7z文件上传到网盘的"测试"文件夹内
	u -p 1 -retry 100 "D:\download" "D:\download\test.7z" "/测试/测试2"  #将download文件夹和test.7z文件上传到网盘的"/测试/测试2"路径下
(上传过程中界面可能会卡住, 此时按一下空格即可)
- 上传完成后, 使用秒传脚本生成秒传即可, 通过此方法上传的文件一般秒传立即生效, 若无效可等待几分钟再重试

## 修改文件md5方法

### 重新压缩
如题, 随便添加些无效文件(比如txt)然后再重新压缩, 即修改了压缩包内容, 即修改了md5, 然后再重新上传即可

### md5修改工具
提供[md5修改工具](https://wws.lanzous.com/iuFGbkddsji), 可直接修改压缩包md5, 无需重新压缩, 如下图所示:

![avatar](https://pic.rmb.bdstatic.com/bjh/945c43e55207a0af9ec23676ffcc71e3.png)

注意: 此工具不适用于7z分卷, 7z分卷直接修改md5会导致无法解压, zip分卷和rar分卷则无影响.
